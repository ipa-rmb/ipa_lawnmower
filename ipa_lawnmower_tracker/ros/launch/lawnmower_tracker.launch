<?xml version="1.0"?>
<launch>
	
	<arg name="camera" default="cam3d" />
	<arg name="use_camera" default="false" />
	<arg name="use_file" default="true" />
	
	<group if="$(arg use_camera)">
		<param name="/$(arg camera)/driver/color_mode" value="1"/>
		<param name="/$(arg camera)/driver/z_scaling" value="1.09"/>
		<include file="$(find openni2_launch)/launch/openni2.launch" >
			<arg name="camera" value="$(arg camera)" />
		</include>
	</group>
	
	<include file="$(find ipa_lawnmower_tracker)/ros/launch/fiducials/fiducials.launch" >
		<arg name="rgb_topic" value="/$(arg camera)/rgb" />
		<arg name="yaml_file" value="fiducials_lawnmower.yaml" />
	</include>
	
	<node ns="/lawnmower_tracker" pkg="ipa_lawnmower_tracker" type="lawnmower_tracker" name="lawnmower_tracker" output="screen">
		<remap from="detections" to="/fiducials/detect_fiducials"/>
		<remap from="video_frames" to="/$(arg camera)/rgb/image_raw"/>
		
		<param if="$(arg use_file)" name="from_file" type="bool" value="1"/>
		<param unless="$(arg use_file)" name="from_file" type="bool" value="0"/>
		<param if="$(arg use_file)" name="video_file" value="lawnmower/floor6.mp4"/>
	</node>
	
	<node pkg="image_view" type="image_view" name="image_view" output="screen">
		<remap from="image" to="/fiducials/image"/>
		<param name="autosize" value="true"/>
	</node>
	
</launch>